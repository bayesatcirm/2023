---
title: "Detailed program"
draft: no
date: "`r format(Sys.time(), '%d %B, %Y')`"
headless: false
active: true
weight: 40
# subtitle: DÃ©finition et simulation avec R
# linktitle: MB
editor_options: 
  chunk_output_type: console
---


```{r utils, echo = FALSE, message = FALSE}
library(tidyverse)
library(kableExtra)
# my_palette <- spec_color(1:5, end = 0.9, option = "A", direction = -1)
my_palette <- wesanderson::wes_palette("FantasticFox1", type = "discrete")
get_color <- function(vec){
  map_chr(vec, function(x) 
    if(x %in% c("Coffee break", "Snooze time", "Dinner", "Lunch"))
      return(my_palette[1])
    else if(x %in% c("Invited talk", "Practical session"))
      return(my_palette[2])
    else if(x == "Contributed")
      return(my_palette[3])
    else if(x == "Master Class")
      return(my_palette[4])
    else if(x == "Tutorial")
      return(my_palette[4])
    else
      return(my_palette[5]))
}
print_function <- function(df){
  df %>% 
    mutate(talk_type = cell_spec(
      talk_type, color = "white", bold = T,
      background = get_color(talk_type)
    )) %>% 
  kableExtra::kbl(escape = FALSE,
             col.names = c("", "", "Speaker", "Title", "Abstract")) %>%
  kableExtra::kable_classic("striped")
}
```


<!-- 
TO CHANGE : replace full_abstracts.pdf by the new one
The fully detailed program, containing also the abstracts of the poster session, is available [here](home/full_abstracts.pdf) in the `pdf` format. -->

## A good start on Monday

```{r full_program, eval = TRUE, echo=FALSE, message=FALSE, results='hide', warning=FALSE}
full_program <- read.csv("detailed_program2023.csv", sep = ",", header = TRUE) %>% 
  mutate(id = ifelse(Speaker == "", "",
                            strsplit(Speaker, split = " ") %>% 
           map(2) %>%
           tolower()),
        last_name = paste0("(abstracts/", id, ".html)"),
         Title = ifelse(Title == "", "",
                        paste0("[", Title, "]", last_name))) %>% 
  filter(talk_type %in% c("Introduction", "Master Class", "Contributed", "Invited talk", "Poster session", "Practical session", "Speed mentoring", "Social event", "Closing", "Tutorial"))

abstract_list <- full_program %>% 
  filter(id != "") %>% 
  mutate(Abstract = paste0( '--- 
title: "', Title, '" 
author: "', Speaker, '"
date: ""
output: 
  html_document:
    theme: journal
---
', Abstract))
for(filenames in abstract_list$id){
  file_connection <- file(glue::glue("abstracts/{filenames}.Rmd"))
  writeLines(abstract_list %>% filter(id == filenames) %>% 
               slice(1) %>% 
               pull(Abstract),file_connection)
  close(file_connection)
  rmarkdown::render(input = glue::glue("abstracts/{filenames}.Rmd"),
                    output_file = glue::glue(filenames, ".html"), output_dir ="abstracts")
}

full_program <- full_program  %>%
  dplyr::select(-last_name, -Abstract, -id) 

```


```{r tableau_lundi, message = FALSE, eval = TRUE, echo = FALSE}
lundi <- filter(full_program, Day == "Monday")
print_function(lundi)
```


## A natural continuation on  Tuesday 

```{r mardi, echo = FALSE}
mardi <- filter(full_program, Day == "Tuesday")
print_function(mardi)
```

## The perfect balance on Wednesday

```{r mercredi, echo = FALSE}
mercredi <- filter(full_program, Day == "Wednesday")  
print_function(mercredi)
```

## Without weakening on Thursday

```{r jeudi, echo = FALSE}
jeudi <- filter(full_program, Day == "Thursday") 
print_function(jeudi)
```

## One more for the road on Friday

```{r vendredi, echo = FALSE}
vendredi <- filter(full_program, Day == "Friday")
print_function(vendredi)
```